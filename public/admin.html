<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - Peta Rawan Narkoba</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="/styles.css?v=2.7" />
</head>
<body>
  <nav class="top-nav admin-nav">
    <div class="nav-container">
      <div class="nav-logo-section">
        <img class="nav-logo" src="/logo-bnn.png" id="logoImg" alt="Logo BNN" />
        <div class="nav-text">
          <h1 class="nav-title">Admin Dashboard</h1>
          <p class="nav-subtitle">Kelola Data Rawan Narkoba - Tanjungpinang</p>
        </div>
      </div>
    </div>
  </nav>

  <section class="admin-panel">
    <div class="admin-grid">
      <!-- Banner Section -->
      <div class="admin-card">
        <h2 class="card-title">ğŸ“¸ Update Banner</h2>
        <form id="bannerForm" class="form-group card-content">
          <div class="file-input-wrapper">
            <input type="file" id="bannerInput" name="banner" accept="image/*" />
            <label for="bannerInput" class="file-label">Pilih Gambar Banner</label>
          </div>
          <div class="form-field">
            <label>Caption:</label>
            <input type="text" name="caption" placeholder="Masukkan caption untuk banner..." />
          </div>
          <button type="submit" class="btn btn-danger">ğŸ“¤ Upload Banner</button>
        </form>
      </div>

      <!-- Logo Section -->
      <div class="admin-card">
        <h2 class="card-title">ğŸ›ï¸ Update Logo BNN</h2>
        <form id="logoForm" class="form-group card-content">
          <div style="display:flex; gap:20px; align-items:center;">
            <div style="flex-shrink:0;">
              <img id="logoPreview" src="/logo-bnn.svg" alt="Logo BNN" style="width:60px; height:60px; border-radius:6px; border:2px solid #ddd; background:white; padding:4px;" />
            </div>
            <div style="flex:1;">
              <div id="logoDragDrop" class="logo-drag-drop">
                <input type="file" id="logoInput" name="logo" accept="image/svg+xml,image/png,image/jpeg" style="display:none;" />
                <div style="text-align:center; padding:15px;">
                  <p style="margin:0 0 6px 0; font-weight:600; color:#333; font-size:0.9rem;">ğŸ“ Drop logo atau klik</p>
                  <p style="margin:0; font-size:0.8rem; color:#666;">SVG, PNG, JPG (max 2MB)</p>
                </div>
              </div>
              <button type="submit" class="btn btn-danger" style="margin-top:10px; width:100%;">ğŸ–¼ï¸ Upload Logo</button>
            </div>
          </div>
        </form>
      </div>

      <!-- Point Form Section -->
      <div class="admin-card full-width">
        <h2 class="card-title">â• Tambah Titik Rawan Narkoba</h2>
        <form id="pointForm" class="form-group card-content">
          <button type="button" id="gpsBtn" class="btn btn-primary" style="margin-bottom:15px; width:100%;">ğŸ“ Ambil Koordinat dari GPS Saya</button>
          
          <div class="form-row">
            <div class="form-field">
              <label>Latitude:</label>
              <input type="number" step="any" name="lat" placeholder="cth: 0.9167" required />
            </div>
            <div class="form-field">
              <label>Longitude:</label>
              <input type="number" step="any" name="lng" placeholder="cth: 104.4510" required />
            </div>
          </div>
          
          <div class="form-field">
            <label>Kelurahan (wajib):</label>
            <select name="category" required style="font-size:0.95rem;">
              <option value="">-- Pilih kelurahan --</option>
              <option value="Dompak">Dompak</option>
              <option value="Sei Jang">Sei Jang</option>
              <option value="Tanjung Ayun Sakti">Tanjung Ayun Sakti</option>
              <option value="Tanjungpinang Timur">Tanjungpinang Timur</option>
              <option value="Tanjung Unggat">Tanjung Unggat</option>
              <option value="Bukit Cermin">Bukit Cermin</option>
              <option value="Kampung Baru">Kampung Baru</option>
              <option value="Kemboja">Kemboja</option>
              <option value="Tanjungpinang Barat">Tanjungpinang Barat</option>
              <option value="Kampung Bugis">Kampung Bugis</option>
              <option value="Penyengat">Penyengat</option>
              <option value="Senggarang">Senggarang</option>
              <option value="Tanjungpinang Kota">Tanjungpinang Kota</option>
              <option value="Air Raja">Air Raja</option>
              <option value="Batu IX">Batu IX</option>
              <option value="Kampung Bulang">Kampung Bulang</option>
              <option value="Melayu Kota Piring">Melayu Kota Piring</option>
              <option value="Pinang Kencana">Pinang Kencana</option>
            </select>
          </div>
          
          <div class="form-field">
            <label>Nama Lokasi:</label>
            <input type="text" name="name" placeholder="Contoh: Jalan Raya Kampung Bugis RT 02" required />
          </div>
          
          <div class="form-field">
            <label>Catatan:</label>
            <textarea name="description" placeholder="Keterangan tambahan tentang lokasi ini..." rows="3"></textarea>
          </div>
          
          <button type="submit" class="btn btn-danger" style="font-size:1rem; padding:12px;">â• Tambah Titik Lokasi</button>
        </form>
      </div>

      <!-- Points List Section -->
      <div class="admin-card full-width">
        <h2 class="card-title">ğŸ“‹ Daftar Titik yang Ditambahkan</h2>
        <div class="points-list-wrapper">
          <ul id="pointsList" class="points-list"></ul>
          <div id="emptyState" class="empty-state">
            <p>Belum ada titik yang ditambahkan. Mulai dengan klik peta atau isi form di atas.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    // Force reload logo with cache-busting timestamp
    document.getElementById('logoImg').src = '/logo-bnn.png?t=' + Date.now();
  </script>

  <footer class="footer admin-footer">
    <div class="footer-container">
      <p style="margin:0; font-size:0.85rem;">&copy; 2025 BNN Kota Tanjungpinang - Admin Panel</p>
    </div>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="/admin.js?v=2.7"></script>
</body>
</html>
